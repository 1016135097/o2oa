"function"!=typeof Object.create&&function(){var t=function(){};Object.create=function(e){if(1<arguments.length)throw Error("Second argument not supported");if(null===e)throw Error("Cannot set a null [[Prototype]]");if("object"!=typeof e)throw TypeError("Argument must be an object");t.prototype=e;return new t}}();CKEDITOR.plugins.add("toolbarconfiguratorarea",{afterInit:function(t){t.addMode("wysiwyg",function(e){var o=CKEDITOR.dom.element.createFromHtml('<div class="cke_wysiwyg_div cke_reset" hidefocus="true"></div>');t.ui.space("contents").append(o);o=t.editable(o);o.detach=CKEDITOR.tools.override(o.detach,function(t){return function(){t.apply(this,arguments);this.remove()}});t.setData(t.getData(1),e);t.fire("contentDom")});t.dataProcessor.toHtml=function(t){return t};t.dataProcessor.toDataFormat=function(t){return t}}});Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),o="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),i=o.length;return function(n){if("object"!==typeof n&&("function"!==typeof n||null===n))throw new TypeError("Object.keys called on non-object");var r=[],a;for(a in n)t.call(n,a)&&r.push(a);if(e)for(a=0;a<i;a++)t.call(n,o[a])&&r.push(o[a]);return r}}());(function(){function t(t,e){this.cfg=e||{};this.hidden=false;this.editorId=t;this.fullToolbarEditor=new ToolbarConfigurator.FullToolbarEditor;this.actualConfig=this.originalConfig=this.mainContainer=null;this.isEditableVisible=this.waitForReady=false;this.toolbarContainer=null;this.toolbarButtons=[]}ToolbarConfigurator.AbstractToolbarModifier=t;t.prototype.setConfig=function(t){this._onInit(void 0,t,true)};t.prototype.init=function(t){var e=this;this.mainContainer=new CKEDITOR.dom.element("div");if(this.fullToolbarEditor.editorInstance!==null)throw"Only one instance of ToolbarModifier is allowed";this.editorInstance||this._createEditor(false);this.editorInstance.once("loaded",function(){e.fullToolbarEditor.init(function(){e._onInit(t);if(typeof e.onRefresh=="function")e.onRefresh()},e.editorInstance.config)});return this.mainContainer};t.prototype._onInit=function(t,e){this.originalConfig=this.editorInstance.config;this.actualConfig=e?JSON.parse(e):JSON.parse(JSON.stringify(this.originalConfig));if(!this.actualConfig.toolbarGroups&&!this.actualConfig.toolbar){for(var o=this.actualConfig,i=this.editorInstance.toolbar,n=[],r=i.length,a=0;a<r;a++){var s=i[a];typeof s=="string"?n.push(s):n.push({name:s.name,groups:s.groups?s.groups.slice():[]})}o.toolbarGroups=n}typeof t==="function"&&t(this.mainContainer)};t.prototype._createModifier=function(){this.mainContainer.addClass("unselectable");this.modifyContainer&&this.modifyContainer.remove();this.modifyContainer=new CKEDITOR.dom.element("div");this.modifyContainer.addClass("toolbarModifier");this.mainContainer.append(this.modifyContainer);return this.mainContainer};t.prototype.getEditableArea=function(){return this.editorInstance.container.findOne("#"+this.editorInstance.id+"_contents")};t.prototype._hideEditable=function(){var t=this.getEditableArea();this.isEditableVisible=false;this.lastEditableAreaHeight=t.getStyle("height");t.setStyle("height","0")};t.prototype._showEditable=function(){this.isEditableVisible=true;this.getEditableArea().setStyle("height",this.lastEditableAreaHeight||"auto")};t.prototype._toggleEditable=function(){this.isEditableVisible?this._hideEditable():this._showEditable()};t.prototype._refreshEditor=function(){function t(){e.editorInstance.destroy();e._createEditor(true,e.getActualConfig());e.waitForReady=false}var e=this,o=this.editorInstance.status;if(!this.waitForReady)if(o=="unloaded"||o=="loaded"){this.waitForReady=true;this.editorInstance.once("instanceReady",function(){t()},this)}else t()};t.prototype._createEditor=function(e,o){function i(){}var n=this;this.editorInstance=CKEDITOR.replace(this.editorId);this.editorInstance.on("configLoaded",function(){var e=n.editorInstance.config;o&&CKEDITOR.tools.extend(e,o,true);t.extendPluginsConfig(e)});this.editorInstance.on("uiSpace",function(t){t.data.space!="top"&&t.stop()},null,null,-999);this.editorInstance.once("loaded",function(){var t=n.editorInstance.ui.instances,o;for(o in t)if(t[o]){t[o].click=i;t[o].onClick=i}n.isEditableVisible||n._hideEditable();n.currentActive&&n.currentActive.name&&n._highlightGroup(n.currentActive.name);n.hidden?n.hideUI():n.showUI();if(e&&typeof n.onRefresh==="function")n.onRefresh()})};t.prototype.getActualConfig=function(){return JSON.parse(JSON.stringify(this.actualConfig))};t.prototype._createToolbar=function(){if(this.toolbarButtons.length){this.toolbarContainer=new CKEDITOR.dom.element("div");this.toolbarContainer.addClass("toolbar");for(var t=this.toolbarButtons.length,e=0;e<t;e=e+1)this._createToolbarBtn(this.toolbarButtons[e])}};t.prototype._createToolbarBtn=function(t){var e=ToolbarConfigurator.FullToolbarEditor.createButton(typeof t.text==="string"?t.text:t.text.inactive,t.cssClass);this.toolbarContainer.append(e);e.data("group",t.group);e.addClass(t.position);e.on("click",function(){t.clickCallback.call(this,e,t)},this);return e};t.prototype._fixGroups=function(t){for(var t=t.toolbarGroups||[],e=t.length,o=0;o<e;o=o+1){var i=t[o];if(i=="/"){i=t[o]={};i.type="separator";i.name="separator"+CKEDITOR.tools.getNextNumber()}else{i.groups=i.groups||[];if(CKEDITOR.tools.indexOf(i.groups,i.name)==-1){this.editorInstance.ui.addToolbarGroup(i.name,i.groups[i.groups.length-1],i.name);i.groups.push(i.name)}this._fixSubgroups(i)}}};t.prototype._fixSubgroups=function(t){for(var t=t.groups,e=t.length,o=0;o<e;o=o+1){var i=t[o];t[o]={name:i,totalBtns:ToolbarConfigurator.ToolbarModifier.getTotalSubGroupButtonsNumber(i,this.fullToolbarEditor)}}};t.stringifyJSONintoOneLine=function(t,e){var e=e||{},o=JSON.stringify(t,null,""),o=o.replace(/\n/g,"");if(e.addSpaces){o=o.replace(/(\{|:|,|\[|\])/g,function(t){return t+" "});o=o.replace(/(\])/g,function(t){return" "+t})}e.noQuotesOnKey&&(o=o.replace(/"(\w*)":/g,function(t,e){return e+":"}));e.singleQuotes&&(o=o.replace(/\"/g,"'"));return o};t.prototype.hideUI=function(){this.hidden=true;this.mainContainer.hide();this.editorInstance.container&&this.editorInstance.container.hide()};t.prototype.showUI=function(){this.hidden=false;this.mainContainer.show();this.editorInstance.container&&this.editorInstance.container.show()};t.extendPluginsConfig=function(t){var e=t.extraPlugins,o=t.removePlugins;t.extraPlugins=(e?e+",":"")+"toolbarconfiguratorarea";t.removePlugins=(o?o+",":"")+"autogrow,dialogadvtab,elementspath,enterkey,floatingspace,htmlwriter,magicline,resize,sharedspace,tab,wysiwygarea"}})();