window.ToolbarConfigurator={};(function(){function t(){this.instanceid="fte"+CKEDITOR.tools.getNextId();this.textarea=new CKEDITOR.dom.element("textarea");this.textarea.setAttributes({id:this.instanceid,name:this.instanceid,contentEditable:!0});this.editorInstance=this.buttons=null}ToolbarConfigurator.FullToolbarEditor=t;t.prototype.init=function(o){var n=this;document.body.appendChild(this.textarea.$);CKEDITOR.replace(this.instanceid);this.editorInstance=CKEDITOR.instances[this.instanceid];this.editorInstance.once("configLoaded",function(e){var r=e.editor.config;delete r.removeButtons;delete r.toolbarGroups;delete r.toolbar;ToolbarConfigurator.AbstractToolbarModifier.extendPluginsConfig(r);e.editor.once("loaded",function(){n.buttons=t.toolbarToButtons(n.editorInstance.toolbar);n.buttonsByGroup=t.groupButtons(n.buttons);n.buttonNamesByGroup=n.groupButtonNamesByGroup(n.buttons);e.editor.container.hide();"function"===typeof o&&o(n.buttons)})})};t.prototype.groupButtonNamesByGroup=function(o){var n=this,o=t.groupButtons(o),e;for(e in o)o[e]=t.map(o[e],function(t){return n.getCamelCasedButtonName(t.name)});return o};t.prototype.getGroupByName=function(t){for(var o=this.editorInstance.config.toolbarGroups||this.getFullToolbarGroupsConfig(),n=o.length,e=0;e<n;e+=1)if(o[e].name===t)return o[e];return null};t.prototype.getCamelCasedButtonName=function(t){var o=this.editorInstance.ui.items,n;for(n in o)if(o[n].name==t)return n;return null};t.prototype.getFullToolbarGroupsConfig=function(t){for(var t=!0===t?!0:!1,o=[],n=this.editorInstance.toolbar,e=n.length,r=0;r<e;r+=1){var a=n[r],i={};"string"!=typeof a.name?t&&o.push("/"):(i.name=a.name,a.groups&&(i.groups=Array.prototype.slice.call(a.groups)),o.push(i))}return o};t.filter=function(t,o){for(var n=t&&t.length?t.length:0,e=[],r=0;r<n;r+=1)o(t[r])&&e.push(t[r]);return e};t.map=function(t,o){var n;if(CKEDITOR.tools.isArray(t)){n=[];for(var e=t.length,r=0;r<e;r+=1)n.push(o(t[r]))}else for(e in n={},t)n[e]=o(t[e]);return n};t.groupButtons=function(t){for(var o={},n=t.length,e=0;e<n;e+=1){var r=t[e],a=r.toolbar.split(",")[0];o[a]=o[a]||[];o[a].push(r)}return o};t.toolbarToButtons=function(o){for(var n=[],e=o.length,r=0;r<e;r+=1)"object"==typeof o[r]&&(n=n.concat(t.groupToButtons(o[r])));return n};t.createToolbarButton=function(o){var n=new CKEDITOR.dom.element("a"),e=t.createIcon(o.name,o.icon,o.command);n.setStyle("float","none");n.addClass("cke_"+("rtl"==CKEDITOR.lang.dir?"rtl":"ltr"));if(o instanceof CKEDITOR.ui.button)n.addClass("cke_button"),n.addClass("cke_toolgroup"),n.append(e);else if(CKEDITOR.ui.richCombo&&o instanceof CKEDITOR.ui.richCombo){var e=new CKEDITOR.dom.element("span"),r=new CKEDITOR.dom.element("span"),a=new CKEDITOR.dom.element("span");n.addClass("cke_combo_button");e.addClass("cke_combo_text");e.addClass("cke_combo_inlinelabel");e.setText(o.label);r.addClass("cke_combo_open");a.addClass("cke_combo_arrow");r.append(a);n.append(e);n.append(r)}return n};t.createIcon=function(t,o,n){var e=CKEDITOR.skin.getIconStyle(t,"rtl"==CKEDITOR.lang.dir),e=(e=e||CKEDITOR.skin.getIconStyle(o,"rtl"==CKEDITOR.lang.dir))||CKEDITOR.skin.getIconStyle(n,"rtl"==CKEDITOR.lang.dir),o=new CKEDITOR.dom.element("span");o.addClass("cke_button_icon");o.addClass("cke_button__"+t+"_icon");o.setAttribute("style",e);o.setStyle("float","none");return o};t.createButton=function(t,o){var n=new CKEDITOR.dom.element("button");n.addClass("button-a");if("string"==typeof o)for(var o=o.split(" "),e=o.length;e--;)n.addClass(o[e]);n.setHtml(t);return n};t.groupToButtons=function(o){for(var n=[],e=(o=o.items)?o.length:0,r=0;r<e;r+=1){var a=o[r];if(a instanceof CKEDITOR.ui.button||CKEDITOR.ui.richCombo&&a instanceof CKEDITOR.ui.richCombo)a.$=t.createToolbarButton(a),n.push(a)}return n}})();